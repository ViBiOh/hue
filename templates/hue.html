{{ define "hue" }}
  <style>
    .grid {
      display: grid;
      grid-gap: .5rem;
      grid-template-columns: repeat(auto-fill, minmax(20rem, 1fr));
      margin: .5rem;
    }

    .container {
      border: 1px solid var(--white);
      display: inline-flex;
      flex-direction: column;
      height: 25rem;
    }

    @media screen and (max-width: 424px) {
      .container {
        height: auto;
      }
    }

    .title {
      margin: 0;
      padding: 0;
    }

    .flex {
      display: flex;
    }

    .flex-center {
      align-items: center;
      justify-content: center;
    }

    .flex-grow {
      flex: 1 1;
    }

    .flex-column {
      flex-direction: column;
    }

    .full {
      width: 100%;
    }

    .full-screen {
      max-width: 100vw;
    }

    .medium {
      font-size: 2.4rem;
    }

    .small {
      font-size: 1.6rem;
    }

    .padding-left {
      padding-left: 1rem;
    }

    .ellipsis {
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .relative {
      position: relative;
    }
  </style>

  {{ $root := . }}

  <div class="grid">
    {{ range $id, $group := .Groups }}
      <span class="container">
        <h2 class="small padding-left">Hue - Group</h2>
        <h3 class="header center no-margin {{ if $group.State.AnyOn }}success{{ end }}">{{ $group.Name }}</h3>

        <div class="flex flex-center flex-grow flex-evenly margin-top margin-bottom">
          {{ if $group.Tap }}
            <form method="post" action="/groups/{{ $id }}">
              <input type="hidden" name="method" value="PATCH" />
              <input type="hidden" name="state" value="on" />
              <button type="submit" class="button button-icon">
                <img class="icon icon-large" src="/svg/power-off?fill=limegreen" alt="power-on">
              </button>
            </form>

            <form method="post" action="/groups/{{ $id }}" class="margin-left">
              <input type="hidden" name="method" value="PATCH" />
              <input type="hidden" name="state" value="off" />
              <button type="submit" class="button button-icon">
                <img class="icon icon-large" src="/svg/power-off?fill=crimson" alt="power-off">
              </button>
            </form>
          {{ else }}
            <form method="post" action="/groups/{{ $id }}">
              <input type="hidden" name="method" value="PATCH" />
              <input type="hidden" name="state" value="on" />
              <button type="submit" class="button button-icon">
                <img class="icon icon-large" src="/svg/lightbulb?fill=gold" alt="bright light">
              </button>
            </form>

            <form method="post" action="/groups/{{ $id }}" class="margin-left">
              <input type="hidden" name="method" value="PATCH" />
              <input type="hidden" name="state" value="dimmed" />
              <button type="submit" class="button button-icon">
                <img class="icon icon-large" src="/svg/lightbulb?fill=lightyellow" alt="dim light">
              </button>
            </form>

            <form method="post" action="/groups/{{ $id }}" class="margin-left">
              <input type="hidden" name="method" value="PATCH" />
              <input type="hidden" name="state" value="off" />
              <button type="submit" class="button button-icon">
                <img class="icon icon-large" src="/svg/moon?fill=silver" alt="off light">
              </button>
            </form>
          {{ end }}
        </div>
      </span>
    {{ end }}

    {{ range $id, $schedule := .Schedules }}
      <span class="container">
        <h2 class="small padding-left">Hue - Schedule</h2>
        <h3 class="header center no-margin">{{ $schedule.Name }}</h3>

        <div class="center padding">
          <strong>{{ $schedule.FindStateName $root.Scenes }} state on {{ $schedule.FormatLocalTime }}</strong>
        </div>

        <div class="center flex-full flex flex-center flex-evenly margin-bottom">
          <form class="inline" method="post" action="/schedules/{{ .ID }}">
            <input type="hidden" name="method" value="PATCH" />
            <input type="hidden" name="name" value="{{ .Name }}" />
            <input type="hidden" name="status" value="{{ if eq $schedule.Status "enabled" }}disabled{{ else }}enabled{{ end }}" />

            <button type="submit" class="button button-icon">
              {{ if eq $schedule.Status "enabled" }}
                <img class="icon icon-large" src="/svg/toggle-on?fill=limegreen" alt="toggled on">
              {{ else }}
                <img class="icon icon-large" src="/svg/toggle-on-reverse?fill=crimson" alt="toggled off">
              {{ end }}
            </button>
          </form>
        </div>
      </span>
    {{ end }}

    {{ range $name, $sensor := .Sensors }}
      <span class="container">
        <h2 class="small padding-left">Hue - Sensor</h2>
        <h3 class="header center no-margin {{ if $sensor.State.Presence }}success{{ end }}">{{ $sensor.Name }} Sensor</h3>

        {{ if $sensor.Config.LedIndication }}
          <h3 class="header center no-margin danger">LED</h3>
        {{ end }}

        <div class="center padding">
          <img class="icon icon-large" src="/svg/{{ battery $sensor.Config.Battery }}" alt="{{ $sensor.Config.Battery }}%" title="{{ $sensor.Config.Battery }}%">
        </div>

        <div class="flex flex-center padding">
          <img class="icon icon-large" src="/svg/{{ temperature $sensor.State.Temperature }}" alt="Temperature">
          <strong>{{ $sensor.State.Temperature }}Â°c</strong>
        </div>
      </span>
    {{ end }}
  </div>
{{ end }}
